# Ê†ºÂºèÊ£ÄÊµãË∞ÉËØïÊó•Âøó‰ΩøÁî®ÊåáÂçó

## Ê¶ÇËø∞

ÊàëÂ∑≤ÁªèÂú® `NativeEditorContext.swift` ‰∏≠Ê∑ªÂä†‰∫ÜËØ¶ÁªÜÁöÑË∞ÉËØïÊó•ÂøóÔºåÂ∏ÆÂä©‰Ω†ÁêÜËß£ÊñáÊú¨Ê†ºÂºèÁöÑÂà§Êñ≠ÈÄªËæë„ÄÇ

## Â¶Ç‰ΩïÊü•ÁúãË∞ÉËØïÊó•Âøó

1. **ËøêË°åÂ∫îÁî®Á®ãÂ∫è**Ôºö
   ```bash
   xcodebuild -project MiNoteMac.xcodeproj -scheme MiNoteMac -configuration Debug
   ```
   ÊàñËÄÖÁõ¥Êé•Âú® Xcode ‰∏≠ËøêË°åÔºàCmd+RÔºâ

2. **Êü•ÁúãÊéßÂà∂Âè∞ËæìÂá∫**Ôºö
   - Âú® Xcode ‰∏≠ÔºöÊâìÂºÄÂ∫ïÈÉ®ÁöÑÊéßÂà∂Âè∞Èù¢ÊùøÔºàCmd+Shift+YÔºâ
   - ÊàñËÄÖÊü•ÁúãÁ≥ªÁªüÊó•ÂøóÔºö`Console.app` ‚Üí ÊêúÁ¥¢ "NativeEditorContext"

## Ë∞ÉËØïÊó•ÂøóËØ¥Êòé

### 1. Ê†ºÂºèÊõ¥Êñ∞ÊµÅÁ®ãÔºàupdateCurrentFormatsÔºâ

ÂΩì‰Ω†ÈÄâ‰∏≠ÊñáÊú¨ÊàñÁßªÂä®ÂÖâÊ†áÊó∂Ôºå‰ºöËß¶ÂèëÊ†ºÂºèÊ£ÄÊµãÔºåÊó•ÂøóÊ†ºÂºèÂ¶Ç‰∏ãÔºö

```
[NativeEditorContext] ========================================
[NativeEditorContext] üîÑ ÂºÄÂßãÊõ¥Êñ∞ÂΩìÂâçÊ†ºÂºèÁä∂ÊÄÅ
[NativeEditorContext] ========================================
[NativeEditorContext]   - ÊñáÊú¨ÈïøÂ∫¶: 100
[NativeEditorContext]   - ÂÖâÊ†á‰ΩçÁΩÆ: 50
[NativeEditorContext]   - ÈÄâ‰∏≠ËåÉÂõ¥: location=45, length=10
```

**ÂÖ≥ÈîÆ‰ø°ÊÅØ**Ôºö
- **ÊñáÊú¨ÈïøÂ∫¶**ÔºöÂΩìÂâçÁºñËæëÂô®‰∏≠ÁöÑÊÄªÂ≠óÁ¨¶Êï∞
- **ÂÖâÊ†á‰ΩçÁΩÆ**ÔºöÂÖâÊ†áÂú®ÊñáÊú¨‰∏≠ÁöÑ‰ΩçÁΩÆÔºà‰ªé0ÂºÄÂßãÔºâ
- **ÈÄâ‰∏≠ËåÉÂõ¥**ÔºöÂ¶ÇÊûú length=0 Ë°®Á§∫Êú™ÈÄâ‰∏≠ÊñáÊú¨ÔºàÂÖâÊ†áÊ®°ÂºèÔºâÔºåÂê¶ÂàôË°®Á§∫ÈÄâ‰∏≠‰∫ÜÊñáÊú¨

### 2. Â≠ó‰ΩìÊ†ºÂºèÊ£ÄÊµãÔºàdetectFontFormatsÔºâ

ËøôÊòØÊúÄÂÖ≥ÈîÆÁöÑÈÉ®ÂàÜÔºåÊòæÁ§∫Â¶Ç‰ΩïÂà§Êñ≠ÊñáÊú¨ÊòØÊ†áÈ¢òËøòÊòØÊ≠£ÊñáÔºö

```
[NativeEditorContext] ========== ÂºÄÂßãÊ£ÄÊµãÂ≠ó‰ΩìÊ†ºÂºè ==========
[NativeEditorContext] detectFontFormats - Â±ûÊÄßÈîÆ: ["NSFont", "NSParagraphStyle", "NSColor"]
```

#### 2.1 Ê£ÄÊµã headingLevel Â±ûÊÄßÔºàÊúÄÈ´ò‰ºòÂÖàÁ∫ßÔºâ

```
[NativeEditorContext] ‚úÖ Ê£ÄÊµãÂà∞ headingLevel Â±ûÊÄß: 3
[NativeEditorContext] ‚úÖ Ê†πÊçÆ headingLevel=3 ËØÜÂà´‰∏∫„Äê‰∏âÁ∫ßÊ†áÈ¢ò„Äë
```

**ËØ¥Êòé**Ôºö
- Â¶ÇÊûúÊñáÊú¨Êúâ `headingLevel` Ëá™ÂÆö‰πâÂ±ûÊÄßÔºåÁõ¥Êé•Ê†πÊçÆËøô‰∏™Â±ûÊÄßÂà§Êñ≠
- `headingLevel=1` ‚Üí Â§ßÊ†áÈ¢ò
- `headingLevel=2` ‚Üí ‰∫åÁ∫ßÊ†áÈ¢ò
- `headingLevel=3` ‚Üí ‰∏âÁ∫ßÊ†áÈ¢ò

#### 2.2 ÈÄöËøáÂ≠ó‰ΩìÂ§ßÂ∞èÂà§Êñ≠ÔºàÂ§áÁî®ÊñπÂºèÔºâ

Â¶ÇÊûúÊ≤°Êúâ `headingLevel` Â±ûÊÄßÔºå‰ºöÈÄöËøáÂ≠ó‰ΩìÂ§ßÂ∞èÂà§Êñ≠Ôºö

```
[NativeEditorContext] ‚ÑπÔ∏è Ê≤°ÊúâÊ£ÄÊµãÂà∞ headingLevel Â±ûÊÄßÔºåÂ∞ÜÂ∞ùËØïÈÄöËøáÂ≠ó‰ΩìÂ§ßÂ∞èÂà§Êñ≠
[NativeEditorContext] üìè Â≠ó‰Ωì‰ø°ÊÅØ:
[NativeEditorContext]   - Â≠ó‰ΩìÂêçÁß∞: PingFangSC-Regular
[NativeEditorContext]   - Â≠ó‰ΩìÂ§ßÂ∞è: 13.0pt
[NativeEditorContext]   - Â≠ó‰ΩìÁâπÊÄß: bold=false, italic=false
[NativeEditorContext] üîç ÂºÄÂßãÈÄöËøáÂ≠ó‰ΩìÂ§ßÂ∞èÂà§Êñ≠Ê†áÈ¢òÁ±ªÂûã...
[NativeEditorContext]   ÂΩìÂâçÈòàÂÄº: Â§ßÊ†áÈ¢ò>=20pt, ‰∫åÁ∫ßÊ†áÈ¢ò>=16pt, ‰∏âÁ∫ßÊ†áÈ¢ò>=14pt
[NativeEditorContext] ‚úÖ Â≠ó‰ΩìÂ§ßÂ∞è 13.0pt < 14ptÔºåËØÜÂà´‰∏∫„ÄêÊ≠£Êñá„ÄëÔºà‰∏çÊ∑ªÂä†Ê†áÈ¢òÊ†ºÂºèÔºâ
```

**ÂΩìÂâçÈòàÂÄº**ÔºàËøôÊòØÈóÆÈ¢òÊâÄÂú®ÔºâÔºö
- **Â§ßÊ†áÈ¢ò**ÔºöÂ≠ó‰ΩìÂ§ßÂ∞è >= 20pt
- **‰∫åÁ∫ßÊ†áÈ¢ò**ÔºöÂ≠ó‰ΩìÂ§ßÂ∞è >= 16pt ‰∏î < 20pt
- **‰∏âÁ∫ßÊ†áÈ¢ò**ÔºöÂ≠ó‰ΩìÂ§ßÂ∞è >= 14pt ‰∏î < 16pt  ‚ö†Ô∏è **ÈóÆÈ¢òÔºö14pt Ë¢´ËØÜÂà´‰∏∫‰∏âÁ∫ßÊ†áÈ¢ò**
- **Ê≠£Êñá**ÔºöÂ≠ó‰ΩìÂ§ßÂ∞è < 14pt

**ÈóÆÈ¢òÁ§∫‰æã**Ôºö
```
[NativeEditorContext] ‚úÖ Â≠ó‰ΩìÂ§ßÂ∞è 14.0pt Âú® [14, 16) ËåÉÂõ¥ÂÜÖÔºåËØÜÂà´‰∏∫„Äê‰∏âÁ∫ßÊ†áÈ¢ò„Äë
```
ËøôÂ∞±ÊòØ‰∏∫‰ªÄ‰πà 14pt ÁöÑÊ≠£ÊñáË¢´ËØØÂà§‰∏∫‰∏âÁ∫ßÊ†áÈ¢òÔºÅ

### 3. ÊÆµËêΩÊ†∑ÂºèËΩ¨Êç¢ÔºàdetectParagraphStyleFromFormatsÔºâ

Â∞ÜÊ£ÄÊµãÂà∞ÁöÑÊ†ºÂºèËΩ¨Êç¢‰∏∫ÊÆµËêΩÊ†∑ÂºèÂ≠óÁ¨¶‰∏≤Ôºö

```
[NativeEditorContext] ========== ÂºÄÂßãËΩ¨Êç¢Ê†ºÂºè‰∏∫ÊÆµËêΩÊ†∑Âºè ==========
[NativeEditorContext] ËæìÂÖ•Ê†ºÂºèÈõÜÂêà: ["‰∏âÁ∫ßÊ†áÈ¢ò"]
[NativeEditorContext] ‚úÖ Ê£ÄÊµãÂà∞ heading3 Ê†ºÂºèÔºåËøîÂõûÊÆµËêΩÊ†∑Âºè: „Äêsubtitle„Äë(‰∏âÁ∫ßÊ†áÈ¢ò)
[NativeEditorContext] ========== ÊÆµËêΩÊ†∑ÂºèËΩ¨Êç¢ÂÆåÊàê: subtitle ==========
```

**ÊÆµËêΩÊ†∑ÂºèÊò†Â∞Ñ**Ôºö
- `heading1` ‚Üí "heading" (Â§ßÊ†áÈ¢ò)
- `heading2` ‚Üí "subheading" (‰∫åÁ∫ßÊ†áÈ¢ò)
- `heading3` ‚Üí "subtitle" (‰∏âÁ∫ßÊ†áÈ¢ò)
- ÂÖ∂‰ªñ ‚Üí "body" (Ê≠£Êñá)

### 4. ÊúÄÁªàÁªìÊûú

```
[NativeEditorContext] ----------------------------------------
[NativeEditorContext] üìä ÊúÄÁªàÊ£ÄÊµãÂà∞ÁöÑÊâÄÊúâÊ†ºÂºè: ["‰∏âÁ∫ßÊ†áÈ¢ò"]
[NativeEditorContext] ----------------------------------------
[NativeEditorContext] ========================================
[NativeEditorContext] ‚úÖ Ê†ºÂºèÁä∂ÊÄÅÊõ¥Êñ∞ÂÆåÊàê
[NativeEditorContext] ========================================
```

## ÊµãËØïÊ≠•È™§

### ÊµãËØïÂú∫ÊôØ 1ÔºöÊ≠£ÊñáÊñáÊú¨Ôºà13ptÔºâ

1. Âú®ÁºñËæëÂô®‰∏≠ËæìÂÖ•‰∏Ä‰∫õÊñáÊú¨ÔºàÈªòËÆ§Â≠ó‰ΩìÂ§ßÂ∞è‰∏∫ 13ptÔºâ
2. ÈÄâ‰∏≠Ëøô‰∫õÊñáÊú¨
3. Êü•ÁúãÊó•ÂøóÔºåÂ∫îËØ•ÁúãÂà∞Ôºö
   ```
   [NativeEditorContext] ‚úÖ Â≠ó‰ΩìÂ§ßÂ∞è 13.0pt < 14ptÔºåËØÜÂà´‰∏∫„ÄêÊ≠£Êñá„Äë
   [NativeEditorContext] ‚úÖ Ê≤°ÊúâÊ£ÄÊµãÂà∞‰ªª‰ΩïÂùóÁ∫ßÊ†ºÂºèÔºåËøîÂõûÈªòËÆ§ÊÆµËêΩÊ†∑Âºè: „Äêbody„Äë(Ê≠£Êñá)
   ```

### ÊµãËØïÂú∫ÊôØ 2Ôºö14pt ÊñáÊú¨ÔºàÈóÆÈ¢òÂú∫ÊôØÔºâ

1. ÈÄâ‰∏≠ÊñáÊú¨ÔºåÊâãÂä®Â∞ÜÂ≠ó‰ΩìÂ§ßÂ∞èÊîπ‰∏∫ 14pt
2. Êü•ÁúãÊó•ÂøóÔºåÂ∫îËØ•ÁúãÂà∞Ôºö
   ```
   [NativeEditorContext] ‚úÖ Â≠ó‰ΩìÂ§ßÂ∞è 14.0pt Âú® [14, 16) ËåÉÂõ¥ÂÜÖÔºåËØÜÂà´‰∏∫„Äê‰∏âÁ∫ßÊ†áÈ¢ò„Äë
   [NativeEditorContext] ‚úÖ Ê£ÄÊµãÂà∞ heading3 Ê†ºÂºèÔºåËøîÂõûÊÆµËêΩÊ†∑Âºè: „Äêsubtitle„Äë(‰∏âÁ∫ßÊ†áÈ¢ò)
   ```
   **ËøôÂ∞±ÊòØÈóÆÈ¢òÊâÄÂú®ÔºÅ**

### ÊµãËØïÂú∫ÊôØ 3ÔºöÁúüÊ≠£ÁöÑ‰∏âÁ∫ßÊ†áÈ¢ò

1. ÈÄâ‰∏≠ÊñáÊú¨ÔºåÈÄöËøáÊ†ºÂºèËèúÂçïÂ∫îÁî®"‰∏âÁ∫ßÊ†áÈ¢ò"Ê†ºÂºè
2. Êü•ÁúãÊó•ÂøóÔºåÂ∫îËØ•ÁúãÂà∞Ôºö
   ```
   [NativeEditorContext] ‚úÖ Ê£ÄÊµãÂà∞ headingLevel Â±ûÊÄß: 3
   [NativeEditorContext] ‚úÖ Ê†πÊçÆ headingLevel=3 ËØÜÂà´‰∏∫„Äê‰∏âÁ∫ßÊ†áÈ¢ò„Äë
   ```

## ‰∏ã‰∏ÄÊ≠•Ôºö‰øÆÂ§çÈòàÂÄº

Ê†πÊçÆËÆæËÆ°ÊñáÊ°£ÔºåÊàë‰ª¨ÈúÄË¶ÅÂ∞ÜÈòàÂÄºË∞ÉÊï¥‰∏∫Ôºö
- **Â§ßÊ†áÈ¢ò**Ôºö>= 20pt
- **‰∫åÁ∫ßÊ†áÈ¢ò**Ôºö>= 17pt ‰∏î < 20ptÔºà‰ªé 16pt ÊèêÈ´òÂà∞ 17ptÔºâ
- **‰∏âÁ∫ßÊ†áÈ¢ò**Ôºö>= 15pt ‰∏î < 17ptÔºà‰ªé 14pt ÊèêÈ´òÂà∞ 15ptÔºâ
- **Ê≠£Êñá**Ôºö< 15ptÔºà‰ªé < 14pt Êîπ‰∏∫ < 15ptÔºâ

ËøôÊ†∑ 13pt Âíå 14pt ÁöÑÊñáÊú¨ÈÉΩ‰ºöË¢´Ê≠£Á°ÆËØÜÂà´‰∏∫Ê≠£Êñá„ÄÇ

## Êó•ÂøóÁ¨¶Âè∑ËØ¥Êòé

- ‚úÖ ÊàêÂäü/ÂÆåÊàê
- ‚ùå ÈîôËØØ/Â§±Ë¥•
- ‚ö†Ô∏è Ë≠¶Âëä
- ‚ÑπÔ∏è ‰ø°ÊÅØ
- üîÑ ÂºÄÂßãÂ§ÑÁêÜ
- üìè ÊµãÈáè/Êï∞ÂÄº
- üîç Ê£ÄÊµã/ÊêúÁ¥¢
- üì¶ Êï∞ÊçÆ/Â±ûÊÄß
- üìä ÁªìÊûú/ÁªüËÆ°
- üí° ÊèêÁ§∫/ËØ¥Êòé
- üìù ÊñáÊú¨/ÂÜÖÂÆπ
- üìç ‰ΩçÁΩÆ/ÂÖâÊ†á
