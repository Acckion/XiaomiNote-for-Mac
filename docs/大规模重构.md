 ---                                                                    
  MiNote macOS æ¶æ„é‡æ„æŒ‡å¯¼æ–‡æ¡£                                          
                                                                         
  æ–‡æ¡£æ¦‚è¿°                                                               
                                                                         
  æœ¬æ–‡æ¡£ä¸º MiNote macOS é¡¹ç›®æä¾›ç³»ç»Ÿæ€§çš„æ¶æ„é‡æ„æ–¹æ¡ˆï¼Œæ—¨åœ¨è§£å†³å½“å‰æ¶æ„ä¸­ 
  çš„å…³é”®é—®é¢˜ï¼Œä¸ºæœªæ¥çš„å¤§è§„æ¨¡å¼€å‘å¥ å®šåŸºç¡€ã€‚                               
                                                                         
  é¢„è®¡æ€»å·¥ä½œé‡ï¼š 4-6 ä¸ªæœˆï¼ˆ2-3 åå¼€å‘è€…ï¼‰                                
                                                                         
  æœ€åæ›´æ–°ï¼š 2026-01-22                                                  
                                                                         
  ---                                                                    
  ç›®å½•                                                                   
                                                                         
  1. #1-å½“å‰æ¶æ„é—®é¢˜æ€»ç»“                                                 
  2. #2-é‡æ„æ€»ä½“ç­–ç•¥                                                     
  3. #3-é˜¶æ®µ-1å»ºç«‹åŸºç¡€è®¾æ–½2-3-å‘¨                                         
  4. #4-é˜¶æ®µ-2æ‹†åˆ†æ ¸å¿ƒç»„ä»¶4-6-å‘¨                                         
  5. #5-é˜¶æ®µ-3é‡æ„æœåŠ¡å±‚3-4-å‘¨                                           
  6. #6-é˜¶æ®µ-4æ€§èƒ½ä¼˜åŒ–2-3-å‘¨                                             
  7. #7-é£é™©ç®¡ç†ä¸å›æ»šç­–ç•¥                                               
  8. #8-æˆåŠŸæŒ‡æ ‡                                                         
                                                                         
  ---                                                                    
  1. å½“å‰æ¶æ„é—®é¢˜æ€»ç»“                                                    
                                                                         
  1.1 å…³é”®é—®é¢˜                                                           
  é—®é¢˜: NotesViewModel ä¸Šå¸å¯¹è±¡ï¼ˆ4,530 è¡Œï¼‰                              
  ä¸¥é‡ç¨‹åº¦: ğŸ”´ å…³é”®                                                      
  å½±å“: æ— æ³•å¹¶è¡Œå¼€å‘ã€æµ‹è¯•å›°éš¾ã€æ€§èƒ½é—®é¢˜                                 
  ä½ç½®: Sources/ViewModel/NotesViewModel.swift                           
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               
  é—®é¢˜: å•ä¾‹æ¨¡å¼æ»¥ç”¨ï¼ˆ45+ ä¸ªï¼‰                                           
  ä¸¥é‡ç¨‹åº¦: ğŸ”´ å…³é”®                                                      
  å½±å“: æ— æ³•æµ‹è¯•ã€éšè—ä¾èµ–ã€å†…å­˜æ³„æ¼                                     
  ä½ç½®: å…¨å±€                                                             
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               
  é—®é¢˜: çŠ¶æ€ç®¡ç†ç¢ç‰‡åŒ–ï¼ˆ9+ ä¸ªç®¡ç†å™¨ï¼‰                                    
  ä¸¥é‡ç¨‹åº¦: ğŸ”´ å…³é”®                                                      
  å½±å“: çŠ¶æ€ä¸ä¸€è‡´ã€åŒæ­¥ bugã€éš¾ä»¥è°ƒè¯•                                   
  ä½ç½®: å…¨å±€                                                             
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               
  é—®é¢˜: ç¼ºä¹åè®®æŠ½è±¡                                                     
  ä¸¥é‡ç¨‹åº¦: ğŸŸ¡ é«˜                                                        
  å½±å“: ç´§è€¦åˆã€æ— æ³• mock                                                
  ä½ç½®: Service å±‚                                                       
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               
  é—®é¢˜: å¤§å‹æœåŠ¡æ–‡ä»¶ï¼ˆ3,000+ è¡Œï¼‰                                        
  ä¸¥é‡ç¨‹åº¦: ğŸŸ¡ é«˜                                                        
  å½±å“: éš¾ä»¥ç»´æŠ¤ã€èŒè´£ä¸æ¸…                                               
  ä½ç½®: Service å±‚                                                       
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                               
  é—®é¢˜: å¾ªç¯ä¾èµ–                                                         
  ä¸¥é‡ç¨‹åº¦: ğŸŸ¢ ä¸­                                                        
  å½±å“: å†…å­˜ç®¡ç†å¤æ‚ã€æ•°æ®æµæ··ä¹±                                         
  ä½ç½®: ViewModel â†” Coordinator                                          
  1.2 å¦‚æœä¸é‡æ„çš„åæœ                                                   
                                                                         
  - 6 ä¸ªæœˆå†…ï¼š å¼€å‘é€Ÿåº¦é™ä½ 50%ï¼Œå›¢é˜Ÿæ‰©å±•å¤±è´¥                            
  - 12 ä¸ªæœˆå†…ï¼š ä»£ç åº“å˜å¾—æ— æ³•ç»´æŠ¤ï¼ŒæŠ€æœ¯å€ºåŠ¡å¤±æ§                         
  - 18 ä¸ªæœˆå†…ï¼š å¯èƒ½éœ€è¦å®Œå…¨é‡å†™                                         
                                                                         
  ---                                                                    
  2. é‡æ„æ€»ä½“ç­–ç•¥                                                        
                                                                         
  2.1 æ ¸å¿ƒåŸåˆ™                                                           
                                                                         
  1. æ¸è¿›å¼é‡æ„ - ä¸åœæ­¢æ–°åŠŸèƒ½å¼€å‘ï¼Œé€æ­¥æ”¹è¿›                             
  2. æµ‹è¯•å…ˆè¡Œ - æ¯æ¬¡é‡æ„å‰åéƒ½æœ‰æµ‹è¯•ä¿æŠ¤                                 
  3. å‘åå…¼å®¹ - æ–°æ—§ä»£ç å…±å­˜ï¼Œé€æ­¥è¿ç§»                                   
  4. é£é™©å¯æ§ - æ¯ä¸ªé˜¶æ®µéƒ½å¯ä»¥å›æ»š                                       
                                                                         
  2.2 é‡æ„è·¯çº¿å›¾                                                         
                                                                         
  é˜¶æ®µ 1: åŸºç¡€è®¾æ–½ (2-3 å‘¨)                                              
      â†“                                                                  
  é˜¶æ®µ 2: æ‹†åˆ†æ ¸å¿ƒ (4-6 å‘¨)                                              
      â†“                                                                  
  é˜¶æ®µ 3: æœåŠ¡å±‚é‡æ„ (3-4 å‘¨)                                            
      â†“                                                                  
  é˜¶æ®µ 4: æ€§èƒ½ä¼˜åŒ– (2-3 å‘¨)                                              
                                                                         
  2.3 å¹¶è¡Œå¼€å‘ç­–ç•¥                                                       
                                                                         
  - æ–°åŠŸèƒ½å¼€å‘ï¼š ä½¿ç”¨æ–°æ¶æ„æ¨¡å¼                                          
  - Bug ä¿®å¤ï¼š åœ¨æ—§ä»£ç ä¸­ä¿®å¤ï¼Œä½†è®°å½•æŠ€æœ¯å€ºåŠ¡                            
  - é‡æ„å·¥ä½œï¼š ç‹¬ç«‹åˆ†æ”¯ï¼Œé¢‘ç¹åˆå¹¶                                        
                                                                         
  ---                                                                    
  3. é˜¶æ®µ 1ï¼šå»ºç«‹åŸºç¡€è®¾æ–½ï¼ˆ2-3 å‘¨ï¼‰                                      
                                                                         
  3.1 ç›®æ ‡                                                               
                                                                         
  - å»ºç«‹ä¾èµ–æ³¨å…¥æ¡†æ¶                                                     
  - åˆ›å»ºæœåŠ¡åè®®æŠ½è±¡                                                     
  - æ­å»ºæµ‹è¯•åŸºç¡€è®¾æ–½                                                     
  - å»ºç«‹æ–°çš„ä»£ç è§„èŒƒ                                                     
                                                                         
  3.2 æ­¥éª¤ 1.1ï¼šåˆ›å»ºä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆ3 å¤©ï¼‰                                 
                                                                         
  åˆ›å»º DI å®¹å™¨                                                           
                                                                         
  æ–‡ä»¶ï¼š Sources/Core/DependencyInjection/DIContainer.swift              
                                                                         
  /// ä¾èµ–æ³¨å…¥å®¹å™¨                                                       
  final class DIContainer {                                              
      static let shared = DIContainer()                                  
                                                                         
      private var services: [String: Any] = [:]                          
      private var factories: [String: () -> Any] = [:]                   
                                                                         
      private init() {}                                                  
                                                                         
      /// æ³¨å†Œå•ä¾‹æœåŠ¡                                                   
      func register<T>(_ type: T.Type, instance: T) {                    
          let key = String(describing: type)                             
          services[key] = instance                                       
      }                                                                  
                                                                         
      /// æ³¨å†Œå·¥å‚æ–¹æ³•                                                   
      func register<T>(_ type: T.Type, factory: @escaping () -> T) {     
          let key = String(describing: type)                             
          factories[key] = factory                                       
      }                                                                  
                                                                         
      /// è§£ææœåŠ¡                                                       
      func resolve<T>(_ type: T.Type) -> T {                             
          let key = String(describing: type)                             
                                                                         
          // å…ˆæŸ¥æ‰¾å·²æ³¨å†Œçš„å®ä¾‹                                          
          if let service = services[key] as? T {                         
              return service                                             
          }                                                              
                                                                         
          // å†æŸ¥æ‰¾å·¥å‚æ–¹æ³•                                              
          if let factory = factories[key] {                              
              let instance = factory() as! T                             
              return instance                                            
          }                                                              
                                                                         
          fatalError("Service \(key) not registered")                    
      }                                                                  
  }                                                                      
                                                                         
  åˆ›å»ºæœåŠ¡å®šä½å™¨ï¼ˆå¯é€‰ï¼Œç”¨äºè¿‡æ¸¡æœŸï¼‰                                     
                                                                         
  æ–‡ä»¶ï¼š Sources/Core/DependencyInjection/ServiceLocator.swift           
                                                                         
  /// æœåŠ¡å®šä½å™¨ï¼ˆè¿‡æ¸¡æœŸä½¿ç”¨ï¼Œæœ€ç»ˆåº”è¯¥ç§»é™¤ï¼‰                             
  final class ServiceLocator {                                           
      static let shared = ServiceLocator()                               
      private let container = DIContainer.shared                         
                                                                         
      private init() {}                                                  
                                                                         
      /// é…ç½®æ‰€æœ‰æœåŠ¡                                                   
      func configure() {                                                 
          // æ³¨å†ŒæœåŠ¡ï¼ˆåç»­ä¼šé€æ­¥æ·»åŠ ï¼‰                                  
      }                                                                  
  }                                                                      
                                                                         
  3.3 æ­¥éª¤ 1.2ï¼šåˆ›å»ºæœåŠ¡åè®®ï¼ˆ5 å¤©ï¼‰                                     
                                                                         
  ä¸ºæ¯ä¸ªä¸»è¦æœåŠ¡åˆ›å»ºåè®®æŠ½è±¡ã€‚                                           
                                                                         
  ç¤ºä¾‹ï¼šç½‘ç»œæœåŠ¡åè®®                                                     
                                                                         
  æ–‡ä»¶ï¼š Sources/Service/Network/Protocols/NoteServiceProtocol.swift     
                                                                         
  import Foundation                                                      
                                                                         
  /// ç¬”è®°ç½‘ç»œæœåŠ¡åè®®                                                   
  protocol NoteServiceProtocol {                                         
      // MARK: - ç¬”è®°æ“ä½œ                                                
      func fetchNotes() async throws -> [Note]                           
      func fetchNote(id: String) async throws -> Note                    
      func createNote(_ note: Note) async throws -> Note                 
      func updateNote(_ note: Note) async throws -> Note                 
      func deleteNote(id: String) async throws                           
                                                                         
      // MARK: - åŒæ­¥æ“ä½œ                                                
      func syncNotes(since: Date?) async throws -> SyncResult            
      func uploadChanges(_ changes: [NoteChange]) async throws           
  }                                                                      
                                                                         
  /// åŒæ­¥ç»“æœ                                                           
  struct SyncResult {                                                    
      let notes: [Note]                                                  
      let deletedIds: [String]                                           
      let lastSyncTime: Date                                             
  }                                                                      
                                                                         
  ç¤ºä¾‹ï¼šå­˜å‚¨æœåŠ¡åè®®                                                     
                                                                         
  æ–‡ä»¶ï¼š Sources/Service/Storage/Protocols/NoteStorageProtocol.swift     
                                                                         
  import Foundation                                                      
                                                                         
  /// ç¬”è®°å­˜å‚¨æœåŠ¡åè®®                                                   
  protocol NoteStorageProtocol {                                         
      // MARK: - è¯»å–æ“ä½œ                                                
      func fetchAllNotes() throws -> [Note]                              
      func fetchNote(id: String) throws -> Note?                         
      func fetchNotes(in folderId: String) throws -> [Note]              
      func searchNotes(query: String) throws -> [Note]                   
                                                                         
      // MARK: - å†™å…¥æ“ä½œ                                                
      func saveNote(_ note: Note) throws                                 
      func saveNotes(_ notes: [Note]) throws                             
      func deleteNote(id: String) throws                                 
      func deleteNotes(ids: [String]) throws                             
                                                                         
      // MARK: - æ‰¹é‡æ“ä½œ                                                
      func performBatchUpdate(_ block: () throws -> Void) throws         
  }                                                                      
                                                                         
  ç¤ºä¾‹ï¼šåŒæ­¥æœåŠ¡åè®®                                                     
                                                                         
  æ–‡ä»¶ï¼š Sources/Service/Sync/Protocols/SyncServiceProtocol.swift        
                                                                         
  import Foundation                                                      
  import Combine                                                         
                                                                         
  /// åŒæ­¥æœåŠ¡åè®®                                                       
  protocol SyncServiceProtocol {                                         
      // MARK: - åŒæ­¥çŠ¶æ€                                                
      var isSyncing: AnyPublisher<Bool, Never> { get }                   
      var lastSyncTime: Date? { get }                                    
                                                                         
      // MARK: - åŒæ­¥æ“ä½œ                                                
      func startSync() async throws                                      
      func stopSync()                                                    
      func syncNote(id: String) async throws                             
                                                                         
      // MARK: - ç¦»çº¿é˜Ÿåˆ—                                                
      func queueOperation(_ operation: SyncOperation) throws             
      func processPendingOperations() async throws                       
  }                                                                      
                                                                         
  /// åŒæ­¥æ“ä½œ                                                           
  struct SyncOperation: Codable {                                        
      let id: String                                                     
      let type: OperationType                                            
      let noteId: String                                                 
      let timestamp: Date                                                
                                                                         
      enum OperationType: String, Codable {                              
          case create, update, delete                                    
      }                                                                  
  }                                                                      
                                                                         
  éœ€è¦åˆ›å»ºçš„å…¶ä»–åè®®                                                     
                                                                         
  åˆ›å»ºä»¥ä¸‹åè®®æ–‡ä»¶ï¼š                                                     
                                                                         
  1. AuthenticationServiceProtocol.swift - è®¤è¯æœåŠ¡                      
  2. NetworkMonitorProtocol.swift - ç½‘ç»œç›‘æ§                             
  3. ImageServiceProtocol.swift - å›¾ç‰‡æœåŠ¡                               
  4. AudioServiceProtocol.swift - éŸ³é¢‘æœåŠ¡                               
  5. CacheServiceProtocol.swift - ç¼“å­˜æœåŠ¡                               
                                                                         
  3.4 æ­¥éª¤ 1.3ï¼šæ­å»ºæµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆ4 å¤©ï¼‰                                 
                                                                         
  åˆ›å»ºæµ‹è¯•åŸºç±»                                                           
                                                                         
  æ–‡ä»¶ï¼š Tests/TestSupport/BaseTestCase.swift                            
                                                                         
  import XCTest                                                          
  @testable import MiNoteMac                                             
                                                                         
  class BaseTestCase: XCTestCase {                                       
      var container: DIContainer!                                        
                                                                         
      override func setUp() {                                            
          super.setUp()                                                  
          container = DIContainer()                                      
          configureMockServices()                                        
      }                                                                  
                                                                         
      override func tearDown() {                                         
          container = nil                                                
          super.tearDown()                                               
      }                                                                  
                                                                         
      /// é…ç½® Mock æœåŠ¡                                                 
      func configureMockServices() {                                     
          // å­ç±»é‡å†™æ­¤æ–¹æ³•æ¥æ³¨å†Œ mock æœåŠ¡                              
      }                                                                  
  }                                                                      
                                                                         
  åˆ›å»º Mock æœåŠ¡                                                         
                                                                         
  æ–‡ä»¶ï¼š Tests/Mocks/MockNoteService.swift                               
                                                                         
  import Foundation                                                      
  @testable import MiNoteMac                                             
                                                                         
  class MockNoteService: NoteServiceProtocol {                           
      // MARK: - Mock æ•°æ®                                               
      var mockNotes: [Note] = []                                         
      var mockError: Error?                                              
      var fetchNotesCallCount = 0                                        
                                                                         
      // MARK: - NoteServiceProtocol                                     
      func fetchNotes() async throws -> [Note] {                         
          fetchNotesCallCount += 1                                       
                                                                         
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          return mockNotes                                               
      }                                                                  
                                                                         
      func fetchNote(id: String) async throws -> Note {                  
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          guard let note = mockNotes.first(where: { $0.id == id }) else {
              throw NSError(domain: "MockError", code: 404)              
          }                                                              
                                                                         
          return note                                                    
      }                                                                  
                                                                         
      func createNote(_ note: Note) async throws -> Note {               
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          mockNotes.append(note)                                         
          return note                                                    
      }                                                                  
                                                                         
      func updateNote(_ note: Note) async throws -> Note {               
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          if let index = mockNotes.firstIndex(where: { $0.id == note.id  
  }) {                                                                   
              mockNotes[index] = note                                    
          }                                                              
                                                                         
          return note                                                    
      }                                                                  
                                                                         
      func deleteNote(id: String) async throws {                         
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          mockNotes.removeAll { $0.id == id }                            
      }                                                                  
                                                                         
      func syncNotes(since: Date?) async throws -> SyncResult {          
          if let error = mockError {                                     
              throw error                                                
          }                                                              
                                                                         
          return SyncResult(                                             
              notes: mockNotes,                                          
              deletedIds: [],                                            
              lastSyncTime: Date()                                       
          )                                                              
      }                                                                  
                                                                         
      func uploadChanges(_ changes: [NoteChange]) async throws {         
          if let error = mockError {                                     
              throw error                                                
          }                                                              
      }                                                                  
  }                                                                      
                                                                         
  åˆ›å»ºå…¶ä»– Mock æœåŠ¡                                                     
                                                                         
  åˆ›å»ºä»¥ä¸‹ Mock æ–‡ä»¶ï¼š                                                   
                                                                         
  1. MockNoteStorage.swift                                               
  2. MockSyncService.swift                                               
  3. MockAuthenticationService.swift                                     
  4. MockNetworkMonitor.swift                                            
                                                                         
  3.5 æ­¥éª¤ 1.4ï¼šå»ºç«‹ä»£ç è§„èŒƒï¼ˆ2 å¤©ï¼‰                                     
                                                                         
  åˆ›å»ºæ¶æ„æ–‡æ¡£                                                           
                                                                         
  æ–‡ä»¶ï¼š Docs/Architecture.md                                            
                                                                         
  # MiNote macOS æ¶æ„è§„èŒƒ                                                
                                                                         
  ## æ¶æ„åŸåˆ™                                                            
                                                                         
  1. **ä¾èµ–æ³¨å…¥ä¼˜å…ˆ** - ç¦æ­¢åˆ›å»ºæ–°çš„å•ä¾‹                                 
  2. **åè®®æŠ½è±¡** - æ‰€æœ‰æœåŠ¡å¿…é¡»æœ‰åè®®æ¥å£                               
  3. **å•ä¸€èŒè´£** - æ¯ä¸ªç±»ä¸è¶…è¿‡ 500 è¡Œ                                  
  4. **æµ‹è¯•è¦†ç›–** - æ–°ä»£ç å¿…é¡»æœ‰å•å…ƒæµ‹è¯•                                 
                                                                         
  ## ç›®å½•ç»“æ„                                                            
                                                                         
  Sources/                                                               
  â”œâ”€â”€ Core/               # æ ¸å¿ƒåŸºç¡€è®¾æ–½                                 
  â”‚   â”œâ”€â”€ DependencyInjection/                                           
  â”‚   â””â”€â”€ Extensions/                                                    
  â”œâ”€â”€ Domain/             # é¢†åŸŸæ¨¡å‹ï¼ˆæ–°å¢ï¼‰                             
  â”‚   â”œâ”€â”€ Models/                                                        
  â”‚   â”œâ”€â”€ UseCases/                                                      
  â”‚   â””â”€â”€ Repositories/                                                  
  â”œâ”€â”€ Service/            # æœåŠ¡å±‚                                       
  â”‚   â”œâ”€â”€ Network/                                                       
  â”‚   â”œâ”€â”€ Storage/                                                       
  â”‚   â””â”€â”€ Sync/                                                          
  â”œâ”€â”€ Presentation/       # è¡¨ç°å±‚ï¼ˆæ–°å¢ï¼‰                               
  â”‚   â”œâ”€â”€ ViewModels/                                                    
  â”‚   â””â”€â”€ Views/                                                         
  â””â”€â”€ App/                # åº”ç”¨å…¥å£                                     
                                                                         
  ## å‘½åè§„èŒƒ                                                            
                                                                         
  - **åè®®ï¼š** `XxxProtocol` æˆ– `XxxServiceProtocol`                     
  - **å®ç°ï¼š** `DefaultXxx` æˆ– `XxxImpl`                                 
  - **Mockï¼š** `MockXxx`                                                 
  - **ViewModelï¼š** `XxxViewModel`                                       
  - **UseCaseï¼š** `XxxUseCase`                                           
                                                                         
  ## ä»£ç å®¡æŸ¥æ¸…å•                                                        
                                                                         
  - [ ] æ˜¯å¦ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼Ÿ                                               
  - [ ] æ˜¯å¦æœ‰åè®®æŠ½è±¡ï¼Ÿ                                                 
  - [ ] æ˜¯å¦æœ‰å•å…ƒæµ‹è¯•ï¼Ÿ                                                 
  - [ ] æ–‡ä»¶æ˜¯å¦å°äº 500 è¡Œï¼Ÿ                                            
  - [ ] æ˜¯å¦éµå¾ªå•ä¸€èŒè´£åŸåˆ™ï¼Ÿ                                           
                                                                         
  3.6 é˜¶æ®µ 1 éªŒæ”¶æ ‡å‡†                                                    
                                                                         
  - DIContainer åˆ›å»ºå®Œæˆå¹¶æœ‰æµ‹è¯•                                         
  - è‡³å°‘ 5 ä¸ªæ ¸å¿ƒæœåŠ¡åè®®åˆ›å»ºå®Œæˆ                                        
  - æµ‹è¯•åŸºç¡€è®¾æ–½æ­å»ºå®Œæˆ                                                 
  - è‡³å°‘ 3 ä¸ª Mock æœåŠ¡åˆ›å»ºå®Œæˆ                                          
  - æ¶æ„æ–‡æ¡£ç¼–å†™å®Œæˆ                                                     
  - å›¢é˜Ÿæˆå‘˜ç†è§£æ–°æ¶æ„æ¨¡å¼                                               
                                                                         
  ---                                                                    
  4. é˜¶æ®µ 2ï¼šæ‹†åˆ†æ ¸å¿ƒç»„ä»¶ï¼ˆ4-6 å‘¨ï¼‰                                      
                                                                         
  4.1 ç›®æ ‡                                                               
                                                                         
  - å°† NotesViewModelï¼ˆ4,530 è¡Œï¼‰æ‹†åˆ†ä¸ºå¤šä¸ªä¸“æ³¨çš„ ViewModel              
  - å®ç°ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†                                                   
  - å»ºç«‹æ¸…æ™°çš„æ•°æ®æµ                                                     
                                                                         
  4.2 æ­¥éª¤ 2.1ï¼šåˆ†æ NotesViewModel èŒè´£ï¼ˆ2 å¤©ï¼‰                         
                                                                         
  èŒè´£åˆ†æ                                                               
                                                                         
  å½“å‰ NotesViewModel çš„èŒè´£ï¼š                                           
                                                                         
  1. ç¬”è®°åˆ—è¡¨ç®¡ç† - æ˜¾ç¤ºã€è¿‡æ»¤ã€æ’åº                                     
  2. ç¬”è®°ç¼–è¾‘ - å†…å®¹ç¼–è¾‘ã€æ ¼å¼åŒ–                                         
  3. åŒæ­¥åè°ƒ - è§¦å‘åŒæ­¥ã€å¤„ç†å†²çª                                       
  4. è®¤è¯çŠ¶æ€ - ç™»å½•ã€ç™»å‡º                                               
  5. æœç´¢åŠŸèƒ½ - æœç´¢ç¬”è®°                                                 
  6. æ–‡ä»¶å¤¹ç®¡ç† - åˆ›å»ºã€åˆ é™¤æ–‡ä»¶å¤¹                                       
  7. éŸ³é¢‘é¢æ¿ - å½•éŸ³ã€æ’­æ”¾                                               
  8. ç½‘ç»œç›‘æ§ - åœ¨çº¿/ç¦»çº¿çŠ¶æ€                                            
  9. é”™è¯¯å¤„ç† - æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯                                             
  10. UI çŠ¶æ€ - é€‰æ‹©ã€åŠ è½½çŠ¶æ€                                           
                                                                         
  æ‹†åˆ†æ–¹æ¡ˆ                                                               
                                                                         
  NotesViewModel (4,530 è¡Œ)                                              
      â†“ æ‹†åˆ†ä¸º                                                           
  â”œâ”€â”€ NoteListViewModel (300-400 è¡Œ)      - åˆ—è¡¨å±•ç¤ºã€è¿‡æ»¤ã€æ’åº         
  â”œâ”€â”€ NoteEditorViewModel (400-500 è¡Œ)    - ç¼–è¾‘åŠŸèƒ½                     
  â”œâ”€â”€ SyncCoordinator (300-400 è¡Œ)        - åŒæ­¥åè°ƒ                     
  â”œâ”€â”€ AuthenticationViewModel (200-300 è¡Œ) - è®¤è¯çŠ¶æ€                    
  â”œâ”€â”€ SearchViewModel (200-300 è¡Œ)        - æœç´¢åŠŸèƒ½                     
  â”œâ”€â”€ FolderViewModel (200-300 è¡Œ)        - æ–‡ä»¶å¤¹ç®¡ç†                   
  â””â”€â”€ AudioPanelViewModel (200-300 è¡Œ)    - éŸ³é¢‘åŠŸèƒ½                     
                                                                         
  4.3 æ­¥éª¤ 2.2ï¼šåˆ›å»ºæ–°çš„ ViewModel åŸºç±»ï¼ˆ3 å¤©ï¼‰                          
                                                                         
  åˆ›å»º BaseViewModel                                                     
                                                                         
  æ–‡ä»¶ï¼š Sources/Presentation/ViewModels/Base/BaseViewModel.swift        
                                                                         
  import Foundation                                                      
  import Combine                                                         
                                                                         
  /// ViewModel åŸºç±»                                                     
  @MainActor                                                             
  class BaseViewModel: ObservableObject {                                
      // MARK: - Properties                                              
      private var cancellables = Set<AnyCancellable>()                   
                                                                         
      // MARK: - Lifecycle                                               
      init() {                                                           
          setupBindings()                                                
      }                                                                  
                                                                         
      deinit {                                                           
          cancellables.removeAll()                                       
      }                                                                  
                                                                         
      // MARK: - Setup                                                   
      /// å­ç±»é‡å†™æ­¤æ–¹æ³•æ¥è®¾ç½®ç»‘å®š                                       
      func setupBindings() {                                             
          // å­ç±»å®ç°                                                    
      }                                                                  
                                                                         
      // MARK: - Helpers                                                 
      func addCancellable(_ cancellable: AnyCancellable) {               
          cancellables.insert(cancellable)                               
      }                                                                  
  }                                                                      
                                                                         
  åˆ›å»º LoadableViewModel                                                 
                                                                         
  æ–‡ä»¶ï¼š Sources/Presentation/ViewModels/Base/LoadableViewModel.swift    
                                                                         
  import Foundation                                                      
                                                                         
  /// æ”¯æŒåŠ è½½çŠ¶æ€çš„ ViewModel                                           
  @MainActor                                                             
  class LoadableViewModel: BaseViewModel {                               
      // MARK: - Loading State                                           
      @Published var isLoading = false                                   
      @Published var error: Error?                                       
                                                                         
      // MARK: - Helpers                                                 
      func withLoading<T>(_ operation: () async throws -> T) async       
  rethrows -> T {                                                        
          isLoading = true                                               
          error = nil                                                    
                                                                         
          defer {                                                        
              isLoading = false                                          
          }                                                              
                                                                         
          do {                                                           
              return try await operation()                               
          } catch {                                                      
              self.error = error                                         
              throw error                                                
          }                                                              
      }                                                                  
  }                                                                      
                                                                         
  4.4 æ­¥éª¤ 2.3ï¼šåˆ›å»º NoteListViewModelï¼ˆ5 å¤©ï¼‰                           
                                                                         
  æ–‡ä»¶ï¼š Sources/Presentation/ViewModels/NoteList/NoteListViewModel.swift
                                                                         
  import Foundation                                                      
  import Combine                                                         
                                                                         
  /// ç¬”è®°åˆ—è¡¨ ViewModel                                                 
  @MainActor                                                             
  final class NoteListViewModel: LoadableViewModel {                     
      // MARK: - Dependencies                                            
      private let noteStorage: NoteStorageProtocol                       
      private let syncService: SyncServiceProtocol                       
                                                                         
      // MARK: - Published Properties                                    
      @Published var notes: [Note] = []                                  
      @Published var selectedNoteId: String?                             
      @Published var sortOption: SortOption = .editDate                  
      @Published var filterOption: FilterOption = .all                   
                                                                         
      // MARK: - Computed Properties                                     
      var filteredAndSortedNotes: [Note] {                               
          let filtered = filterNotes(notes, by: filterOption)            
          return sortNotes(filtered, by: sortOption)                     
      }                                                                  
                                                                         
      var selectedNote: Note? {                                          
          guard let id = selectedNoteId else { return nil }              
          return notes.first { $0.id == id }                             
      }                                                                  
                                                                         
      // MARK: - Initialization                                          
      init(                                                              
          noteStorage: NoteStorageProtocol,                              
          syncService: SyncServiceProtocol                               
      ) {                                                                
          self.noteStorage = noteStorage                                 
          self.syncService = syncService                                 
          super.init()                                                   
      }                                                                  
                                                                         
      // MARK: - Setup                                                   
      override func setupBindings() {                                    
          // ç›‘å¬åŒæ­¥å®Œæˆäº‹ä»¶                                            
          syncService.isSyncing                                          
              .sink { [weak self] isSyncing in                           
                  if !isSyncing {                                        
                      Task { await self?.loadNotes() }                   
                  }                                                      
              }                                                          
              .store(in: &cancellables)                                  
      }                                                                  
                                                                         
      // MARK: - Public Methods                                          
      func loadNotes() async {                                           
          await withLoading {                                            
              let loadedNotes = try noteStorage.fetchAllNotes()          
              self.notes = loadedNotes                                   
          }                                                              
      }                                                                  
                                                                         
      func selectNote(_ note: Note) {                                    
          selectedNoteId = note.id                                       
      }                                                                  
                                                                         
      func deselectNote() {                                              
          selectedNoteId = nil                                           
      }                                                                  
                                                                         
      func deleteNote(_ note: Note) async {                              
          await withLoading {                                            
              try noteStorage.deleteNote(id: note.id)                    
              notes.removeAll { $0.id == note.id }                       
                                                                         
              if selectedNoteId == note.id {                             
                  selectedNoteId = nil                                   
              }                                                          
          }                                                              
      }                                                                  
                                                                         
      func changeSortOption(_ option: SortOption) {                      
          sortOption = option                                            
      }                                                                  
                                                                         
      func changeFilterOption(_ option: FilterOption) {                  
          filterOption = option                                          
      }                                                                  
                                                                         
      // MARK: - Private Methods                                         
      private func filterNotes(_ notes: [Note], by filter: FilterOption) 
  -> [Note] {                                                            
          switch filter {                                                
          case .all:                                                     
              return notes                                               
          case .starred:                                                 
              return notes.filter { $0.isStarred }                       
          case .folder(let folderId):                                    
              return notes.filter { $0.folderId == folderId }            
          }                                                              
      }                                                                  
                                                                         
      private func sortNotes(_ notes: [Note], by sort: SortOption) ->    
  [Note] {                                                               
          switch sort {                                                  
          case .editDate:                                                
              return notes.sorted { $0.editDate > $1.editDate }          
          case .createDate:                                              
              return notes.sorted { $0.createDate > $1.createDate }      
          case .title:                                                   
              return notes.sorted { $0.title < $1.title }                
          }                                                              
      }                                                                  
  }                                                                      
                                                                         
  // MARK: - Supporting Types                                            
  extension NoteListViewModel {                                          
      enum SortOption {                                                  
          case editDate                                                  
          case createDate                                                
          case title                                                     
      }                                                                  
                                                                         
      enum FilterOption {                                                
          case all                                                       
          case starred                                                   
          case folder(String)                                            
      }                                                                  
  }                                                                      
                                                                         
  4.5 æ­¥éª¤ 2.4ï¼šåˆ›å»º NoteEditorViewModelï¼ˆ5 å¤©ï¼‰                         
                                                                         
  æ–‡ä»¶ï¼š                                                                 
  Sources/Presentation/ViewModels/NoteEditor/NoteEditorViewModel.swift   
                                                                         
  import Foundation                                                      
  import Combine                                                         
                                                                         
  /// ç¬”è®°ç¼–è¾‘å™¨ ViewModel                                               
  @MainActor                                                             
  final class NoteEditorViewModel: LoadableViewModel {                   
      // MARK: - Dependencies                                            
      private let noteStorage: NoteStorageProtocol                       
      private let syncService: SyncServiceProtocol                       
                                                                         
      // MARK: - Published Properties                                    
      @Published var note: Note?                                         
      @Published var title: String = ""                                  
      @Published var content: NSAttributedString = NSAttributedString()  
      @Published var hasUnsavedChanges = false                           
                                                                         
      // MARK: - Private Properties                                      
      private var autoSaveTask: Task<Void, Never>?                       
      private let autoSaveDelay: TimeInterval = 2.0                      
                                                                         
      // MARK: - Initialization                                          
      init(                                                              
          noteStorage: NoteStorageProtocol,                              
          syncService: SyncServiceProtocol                               
      ) {                                                                
          self.noteStorage = noteStorage                                 
          self.syncService = syncService                                 
          super.init()                                                   
      }                                                                  
                                                                         
      deinit {                                                           
          autoSaveTask?.cancel()                                         
      }                                                                  
                                                                         
      // MARK: - Setup                                                   
      override func setupBindings() {                                    
          // ç›‘å¬æ ‡é¢˜å˜åŒ–                                                
          $title                                                         
              .dropFirst()                                               
              .sink { [weak self] _ in                                   
                  self?.markAsChanged()                                  
                  self?.scheduleAutoSave()                               
              }                                                          
              .store(in: &cancellables)                                  
                                                                         
          // ç›‘å¬å†…å®¹å˜åŒ–                                                
          $content                                                       
              .dropFirst()                                               
              .sink { [weak self] _ in                                   
                  self?.markAsChanged()                                  
                  self?.scheduleAutoSave()                               
              }                                                          
              .store(in: &cancellables)                                  
      }                                                                  
                                                                         
      // MARK: - Public Methods                                          
      func loadNote(id: String) async {                                  
          await withLoading {                                            
              guard let loadedNote = try noteStorage.fetchNote(id: id)   
  else {                                                                 
                  throw NoteError.notFound                               
              }                                                          
                                                                         
              self.note = loadedNote                                     
              self.title = loadedNote.title                              
              self.content = loadedNote.attributedContent                
              self.hasUnsavedChanges = false                             
          }                                                              
      }                                                                  
                                                                         
      func createNewNote() {                                             
          let newNote = Note(                                            
              id: UUID().uuidString,                                     
              title: "æ–°ç¬”è®°",                                           
              content: "",                                               
              createDate: Date(),                                        
              editDate: Date()                                           
          )                                                              
                                                                         
          self.note = newNote                                            
          self.title = newNote.title                                     
          self.content = NSAttributedString()                            
          self.hasUnsavedChanges = true                                  
      }                                                                  
                                                                         
      func saveNote() async {                                            
          guard var currentNote = note else { return }                   
                                                                         
          await withLoading {                                            
              currentNote.title = title                                  
              currentNote.content = content.string                       
              currentNote.attributedContent = content                    
              currentNote.editDate = Date()                              
                                                                         
              try noteStorage.saveNote(currentNote)                      
                                                                         
              self.note = currentNote                                    
              self.hasUnsavedChanges = false                             
                                                                         
              // è§¦å‘åŒæ­¥                                                
              try await syncService.syncNote(id: currentNote.id)         
          }                                                              
      }                                                                  
                                                                         
      func updateTitle(_ newTitle: String) {                             
          title = newTitle                                               
      }                                                                  
                                                                         
      func updateContent(_ newContent: NSAttributedString) {             
          content = newContent                                           
      }                                                                  
                                                                         
      // MARK: - Private Methods                                         
      private func markAsChanged() {                                     
          hasUnsavedChanges = true                                       
      }                                                                  
                                                                         
      private func scheduleAutoSave() {                                  
          autoSaveTask?.cancel()                                         
                                                                         
          autoSaveTask = Task { [weak self] in                           
              guard let self = self else { return }                      
                                                                         
              try? await Task.sleep(nanoseconds:                         
  UInt64(self.autoSaveDelay * 1_000_000_000))                            
                                                                         
              if !Task.isCancelled {                                     
                  await self.saveNote()                                  
              }                                                          
          }                                                              
      }                                                                  
  }                                                                      
                                                                         
  // MARK: - Errors                                                      
  extension NoteEditorViewModel {                                        
      enum NoteError: Error {                                            
          case notFound                                                  
          case saveFailed                                                
      }                                                                  
  }                                                                      
                                                                         
  4.6 æ­¥éª¤ 2.5ï¼šåˆ›å»ºå…¶ä»– ViewModelï¼ˆ10 å¤©ï¼‰                              
                                                                         
  æŒ‰ç…§ç›¸åŒçš„æ¨¡å¼åˆ›å»ºï¼š                                                   
                                                                         
  1. SyncCoordinator.swift - åŒæ­¥åè°ƒ                                    
  2. AuthenticationViewModel.swift - è®¤è¯ç®¡ç†                            
  3. SearchViewModel.swift - æœç´¢åŠŸèƒ½                                    
  4. FolderViewModel.swift - æ–‡ä»¶å¤¹ç®¡ç†                                  
  5. AudioPanelViewModel.swift - éŸ³é¢‘åŠŸèƒ½                                
                                                                         
  4.7 æ­¥éª¤ 2.6ï¼šåˆ›å»º AppCoordinatorï¼ˆ5 å¤©ï¼‰                              
                                                                         
  æ–‡ä»¶ï¼š Sources/Presentation/Coordinators/AppCoordinator.swift          
                                                                         
  import Foundation                                                      
  import Combine                                                         
                                                                         
  /// åº”ç”¨åè°ƒå™¨ - ç®¡ç†æ‰€æœ‰ ViewModel çš„ç”Ÿå‘½å‘¨æœŸå’Œé€šä¿¡                   
  @MainActor                                                             
  final class AppCoordinator: ObservableObject {                         
      // MARK: - ViewModels                                              
      let noteListViewModel: NoteListViewModel                           
      let noteEditorViewModel: NoteEditorViewModel                       
      let syncCoordinator: SyncCoordinator                               
      let authViewModel: AuthenticationViewModel                         
      let searchViewModel: SearchViewModel                               
      let folderViewModel: FolderViewModel                               
      let audioPanelViewModel: AudioPanelViewModel                       
                                                                         
      // MARK: - Dependencies                                            
      private let container: DIContainer                                 
      private var cancellables = Set<AnyCancellable>()                   
                                                                         
      // MARK: - Initialization                                          
      init(container: DIContainer) {                                     
          self.container = container                                     
                                                                         
          // è§£æä¾èµ–                                                    
          let noteStorage = container.resolve(NoteStorageProtocol.self)  
          let syncService = container.resolve(SyncServiceProtocol.self)  
          let authService =                                              
  container.resolve(AuthenticationServiceProtocol.self)                  
                                                                         
          // åˆ›å»º ViewModels                                             
          self.noteListViewModel = NoteListViewModel(                    
              noteStorage: noteStorage,                                  
              syncService: syncService                                   
          )                                                              
                                                                         
          self.noteEditorViewModel = NoteEditorViewModel(                
              noteStorage: noteStorage,                                  
              syncService: syncService                                   
          )                                                              
                                                                         
          self.syncCoordinator = SyncCoordinator(                        
              syncService: syncService                                   
          )                                                              
                                                                         
          self.authViewModel = AuthenticationViewModel(                  
              authService: authService                                   
          )                                                              
                                                                         
          self.searchViewModel = SearchViewModel(                        
              noteStorage: noteStorage                                   
          )                                                              
                                                                         
          self.folderViewModel = FolderViewModel(                        
              noteStorage: noteStorage                                   
          )                                                              
                                                                         
          self.audioPanelViewModel = AudioPanelViewModel(                
              audioService: container.resolve(AudioServiceProtocol.self) 
          )                                                              
                                                                         
          setupCoordination()                                            
      }                                                                  
                                                                         
      // MARK: - Setup                                                   
      private func setupCoordination() {                                 
          // å½“åˆ—è¡¨ä¸­é€‰æ‹©ç¬”è®°æ—¶ï¼ŒåŠ è½½åˆ°ç¼–è¾‘å™¨                            
          noteListViewModel.$selectedNoteId                              
              .compactMap { $0 }                                         
              .sink { [weak self] noteId in                              
                  Task {                                                 
                      await self?.noteEditorViewModel.loadNote(id:       
  noteId)                                                                
                  }                                                      
              }                                                          
              .store(in: &cancellables)                                  
                                                                         
          // å½“ç¼–è¾‘å™¨ä¿å­˜ç¬”è®°æ—¶ï¼Œåˆ·æ–°åˆ—è¡¨                                
          noteEditorViewModel.$hasUnsavedChanges                         
              .filter { !$0 }                                            
              .sink { [weak self] _ in                                   
                  Task {                                                 
                      await self?.noteListViewModel.loadNotes()          
                  }        