# 搜索高亮功能 TODO 列表

## 已完成
1. [x] 创建TODO列表文件
2. [x] 搜索结果展现时，左侧菜单栏文件夹列表取消选中任何文件夹
   - 实现位置：NotesViewModel.swift
   - 实现方式：通过Combine监听searchText变化，当搜索文本不为空时自动设置selectedFolder为nil
3. [x] 笔记列表顶部的应用标题区域，主标题改为搜索，副标题改为找到x个结果
   - 实现位置：ContentView.swift
   - 实现方式：修改navigationTitle和navigationSubtitle逻辑，根据searchText是否为空显示不同标题
4. [x] 笔记列表中搜索到的结果用主题色高亮显示
   - 实现位置：NotesListView.swift
   - 实现方式：在NoteRow中添加highlightText和highlightPreviewText函数，使用黄色高亮显示搜索关键词

## 待实现功能

### 1. 编辑器中也高亮显示（暂时不实现）
- 位置：WebEditorView.swift 或相关编辑器文件
- 复杂度：较高，需要修改编辑器组件
- 状态：暂不实现，先记录在此
- 备注：需要修改Web编辑器组件，在编辑器中高亮显示搜索关键词

## 实现总结

### 已实现功能详情
1. **文件夹选择逻辑**：当用户输入搜索文本时，自动取消选中任何文件夹，确保搜索结果显示所有相关笔记
2. **标题区域更新**：
   - 搜索时：主标题显示"搜索"，副标题显示"找到x个结果"
   - 非搜索时：主标题显示文件夹名称或"所有笔记"，副标题显示"x个备忘录"
3. **笔记列表高亮**：
   - 在笔记标题和预览文本中高亮显示搜索关键词
   - 使用主题色黄色(.yellow)进行高亮
   - 支持大小写不敏感搜索
   - 支持多个匹配位置的高亮显示

### 技术实现
- 使用Combine框架监听searchText变化
- 使用SwiftUI Text视图的组合功能实现高亮
- 通过字符串操作和范围计算实现关键词匹配

### 注意事项
- 保持现有功能不变
- 确保离线搜索也能正常工作
- 高亮功能考虑大小写不敏感
- 主题色使用应用统一的黄色

## 实现计划

### 第一阶段：修改标题和文件夹选择逻辑
1. 修改 ContentView.swift 中的标题逻辑
2. 修改文件夹选择逻辑，搜索时取消选中

### 第二阶段：实现笔记列表高亮
1. 修改 NoteRow 组件
2. 添加搜索关键词高亮功能
3. 确保主题色正确

### 第三阶段：测试和优化
1. 测试搜索功能
2. 确保UI响应正确
3. 优化性能

## 注意事项
- 保持现有功能不变
- 确保离线搜索也能正常工作
- 高亮功能需要考虑大小写不敏感
- 主题色使用应用统一的黄色 (#FFD700 或系统黄色)
